# HTTP Proxy Log

åŸºäº mitmproxy çš„ HTTP ä»£ç†æ—¥å¿—è®°å½•å·¥å…·ï¼Œä¸“é—¨ç”¨äºç›‘æ§å’Œè®°å½• API è¯·æ±‚/å“åº”ï¼Œç‰¹åˆ«é€‚ç”¨äº AI æ¨¡å‹ API çš„è°ƒç”¨åˆ†æã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **è¯·æ±‚ç›‘æ§**: æ‹¦æˆªå¹¶è®°å½• HTTP/HTTPS è¯·æ±‚è¯¦æƒ…
- ğŸ“Š **å“åº”åˆ†æ**: è§£æ API å“åº”ï¼Œæå–ä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯
- ğŸ”’ **å®‰å…¨è„±æ•**: è‡ªåŠ¨éšè— Authorization å¤´ä¸­çš„æ•æ„Ÿä¿¡æ¯
- ğŸ“ **æ–‡ä»¶æ—¥å¿—**: æ—¥å¿—ç»Ÿä¸€ä¿å­˜åœ¨ `logs/` ç›®å½•ï¼ŒæŒ‰æ—¥æœŸå½’æ¡£
- ğŸ—‚ï¸ **è‡ªåŠ¨æ¸…ç†**: è‡ªåŠ¨åˆ é™¤è¶…è¿‡ 7 å¤©çš„æ—¥å¿—æ–‡ä»¶
- ğŸ¯ **AI API ä¼˜åŒ–**: ä¸“é—¨é’ˆå¯¹ OpenAI ç­‰ AI æ¨¡å‹ API è¿›è¡Œä¼˜åŒ–

## å®‰è£…

### ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -e .
```

### ä½¿ç”¨ uv

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate

# å®‰è£…ä¾èµ–
uv pip install -e .
```

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨ä»£ç†

```bash
# ä½¿ç”¨ mitmdump å¯åŠ¨
mitmproxy --mode reverse:{å…·ä½“ä»£ç†çš„url} -p 8080 -s main.py

# æˆ–è€…ç›´æ¥è¿è¡Œä¸»ç¨‹åº
python main.py
```

### ä»£ç†é…ç½®

å°†ä½ çš„åº”ç”¨æˆ–æµè§ˆå™¨é…ç½®ä¸ºä½¿ç”¨ `http://localhost:8080` ä½œä¸º HTTP/HTTPS ä»£ç†ã€‚

## æ—¥å¿—æ–‡ä»¶

- **å­˜å‚¨ä½ç½®**: `logs/` ç›®å½•
- **æ–‡ä»¶æ ¼å¼**: `proxy_YYYYMMDD.log`
- **æ—¥å¿—å†…å®¹**: åŒ…å«æ—¶é—´æˆ³ã€è¯·æ±‚æ–¹æ³•ã€URLã€å“åº”çŠ¶æ€ã€æ•°æ®å¤§å°ç­‰ä¿¡æ¯
- **è‡ªåŠ¨æ¸…ç†**: è¶…è¿‡ 7 å¤©çš„æ—¥å¿—æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ é™¤

## æ—¥å¿—ç¤ºä¾‹

```
2025-09-30 14:30:25,123 - > POST https://api.openai.com/v1/chat/completions
2025-09-30 14:30:25,124 -   req.json keys=['model', 'messages', 'temperature'] model=gpt-3.5-turbo
2025-09-30 14:30:26,456 - < 200 https://api.openai.com/v1/chat/completions len=512
2025-09-30 14:30:26,457 -   data={'id': 'chat-123', 'object': 'chat.completion', 'usage': {'prompt_tokens': 25, 'completion_tokens': 50, 'total_tokens': 75}}
```

## å®‰å…¨ç‰¹æ€§

- Authorization å¤´è‡ªåŠ¨æ›¿æ¢ä¸º `Bearer ***`
- æ—¥å¿—æ–‡ä»¶ä¸ä¼šåŒ…å«çœŸå®çš„ API å¯†é’¥
- æ”¯æŒä¸­æ–‡å’Œå…¶ä»– Unicode å­—ç¬¦

## ä¾èµ–

- Python 3.11+
- mitmproxy >= 10.0.0

## è®¸å¯è¯

[MIT](LICENSE)
